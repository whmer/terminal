<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Chan iana</title>
</head>
<style>
  *{margin:0;padding:0;box-sizing: border-box;}
:root{
    --sam:"SF Pro Text", "SF Pro Icons", system, -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "Helvetica", "Arial", "Lucida Grande", "Ubuntu", "Cantarell", "Fira Sans", sans-serif;
    --color-whats: #a333e4;
    --hazap:hazap;
}
body{font-family: var(--sam);font-size: 20px;background: #000;color: #fff;}
.login{text-align: center;background: #202020;width: 470px;margin: 0 auto 10px;padding: 10px;}
@media(max-width:999px){
    .login{
        width: 80%;
    }
}
.inty{
    width: 100%;
    background: #111111;
    margin: 10px;
    border-radius: 3px;
}

.uploadFFimage{
  display: none;
}

#message-input{
    padding: 10px;
    width: 100%;
    border: none;
    font-family: var(--sam);
    color: #fff;
    background: transparent;
    outline: none;
    font-size: 17px;
}
#hacker{
    font-size: 12px;
    margin-left: 10px;
}

#message-form{
    display: flex;
    background-color: #202020;
    justify-content: space-between;
    z-index: 5;
}

.color-form{
    position: fixed;
    bottom: 0;
    left: 20%;
    right: 20%;
    display: none;
    background: #000;
    border-top: 1px solid #303030e1;
    z-index: 5;
}

.color-formu{
  position: fixed;
    top: 0;
    left: 25%;
    right: 20%;
    background: #000;
    border-top: 1px solid #303030e1;
    z-index: 5;
    display: none;
}

@media(max-width:999px){
  .color-formu{
    position: fixed;
    justify-content: left;
    left: 0;
    right: 0;
    background: #000;
    z-index: 10;
}
.color-form{
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: none;
    background: #000;
    border-top: 1px solid #303030e1;
    z-index: 1;
}
}

.message{
  width: 450px;
  word-wrap: break-word;
  white-space: normal;
}

.message{margin-top: 20px; margin-left: 20%;}

@media(max-width:999px){
  .message{
    width: 70%;
  }
  .message{
    margin-left: 10px;
  }
}


.pi{font-size: 15px;}

#name-input, #Senha{padding: 10px;font-family: var(--sam);background: #111111;border: none;outline: none;color: #fff;width: 80%;font-size: 17px;border-radius: 3px;
}
.log--login{font-size: 17px;font-family: var(--sam);font-weight: 600;padding: 10px; border-radius: 3px;border: none;margin-top: 20px;width: 80%;background: var(--color-whats);
}
.log{font-weight: 500;font-size: 15px;color: #807e7e;
}
#chat-box{
  display: none;
  margin: 20px;
}
.divview{width: 90%; text-align: right;}
.ionicon{width: 40px;}
.uplogf{position: fixed; right:0;
  bottom: 0;}

  .divErrorI{
    display: none;
  }
  .uploadFFimage{
    display: none;
  }
  .usersLogin{display:none;}
</style>
<body>
  <div class="usersLogin">
    <div class="iamgehatsunee">
      <br>
      <img src="./a5c1df36ac5e6760fcc080d05cd422de.jpg" class="hadddsune" width="100%"/><br>
      <div class="dflexUsername">
      <div class="userNameId">
        <span id="usernamegg"></span><br>
        <i style="font-size: 12px; color: #807e7e;" id="usernameid">ID:</i>
      </div>     
      </div>
  
    </div>
    <div class="uploadGfilerimage">
      <div class="hTYfierer-image">
        <div class="usernameDreqxy">
          <img src="./image_search_1641509359235.jpg" class="admindreqxy"/>
        </div>
        <h4>chan iana :</h4>
        <i style="font-size: 14px; color: #807e7e;">
          "name": "chan iana",<br>
          "version": "1.0.0",<br>
          "description": "call when you fall apart",<br>
          "author": "whmer - sam",<br>
          "creator": ""<br>
          "license": "ISC",<br>
        </i>
      </div><br>
    </div>
    <div class="usersjson"></div>
  </div>
  <div class="messagechang">
  <div class="content-container">
    <br><br>
  <div class="login">
    <div class="usernIanalogin" style="display: flex; justify-content: center;">
      <div class="phisher-webp">
        <img src="./STK-20241014-WA0049.webp" style="background: transparent; border: none; width:80px; padding: 0px;"/>
      </div>
      <div class="pain" style="margin-top: 25px; margin-left: 10px; text-align: left;">
        <h2 class="logh2">Sign in</h2>
        <h2 class="log">Crete Username!</h2><br>
      </div>
    </div>
    <br>
      <form class="login--form" id="loginHform">
      <input type="text" id="name-input" name="username" placeholder="Username" onfocus="this.placeholder=''" onblur="this.placeholder='Username'" required/>
      <div class="divview">
        <b id="clickB" style=" font-size: 15px; font-weight: 600; text-decoration:underline; cursor: pointer; margin: 10px;">Show</b>
    </div>
    <input type="password" placeholder="Password" name="password" id="Senha" onblur='this.placeholder="Password"' onfocus='this.placeholder=""' required/>
    <br>
    <div class="divErrorI" id="divErrorI">
        <i style="font-size: 10px; color: red;">Erro! try again</i>
    </div>
    <script>
      document.getElementById('clickB').addEventListener('click', function(){
        var passwordInput = document.getElementById("Senha");
        const clickB = document.getElementById('clickB');
        //const icon = document.querySelector('#view-icon ion-icon');
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            clickB.innerText = "Hide";
            //icon.name = 'eye-outline';
          } else {
              passwordInput.type = "password";
              clickB.innerText = "Show";
            //icon.name = 'eye-off-outline';
        }                    
      })

  
    </script>
      <br>
      <button type="submit" id="loglog" class="log--login" onclick="Hacker()">Sign in</button>
      <script>
        document.getElementById('loginHform').addEventListener('submit', function(event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const formObject = {};
    formData.forEach((value, key) => {
        formObject[key] = value;
    });

    fetch('/chan', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formObject)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
          document.querySelector('.color-form').style.display = 'block';
          document.getElementById('chat-box').style.display = 'block';
          document.querySelector(".login").style.display = "none";
          document.querySelector('.usersLogin').style.display = "block";
          document.querySelector('.color-formu').style.display = "block";
            //window.location.replace('../server/'); 
        } else {  
           erro_p();
           limparInputs(); 
        }

        function erro_p(){
            document.getElementById('divErrorI').style.display = "block";
            //document.getElementById('divErrorI23').style.display = "block";
            time();
        }
        function remover_p(){
            document.getElementById('divErrorI').style.display = "none";
            //document.getElementById('divErrorI23').style.display = "none";
          }

    function limparInputs() {
        document.querySelectorAll('#loginHform input').forEach(input => input.value = '');
    }

    function time(){
      var tempoEspera = 4000; 
      setTimeout(remover_p, tempoEspera);}
    })
    .catch(error => {
        console.error('Erro ao autenticar:', error);
    });
});
      </script>
      <br><br>
      </form>
    </div>
  </div>
  <section class="chat">
  </section>
    <section class="message">
    <div id="chat-box"></div>  
    <div id="messages-container"></div>
  </section>
  <br><br><br>
    <div class="color-form">
      <div class="fileschan">
        <style>
          .fileschan{
            display: flex;
            justify-content: space-between;
          }
          .backCdf{
            position: fixed;
            top: 0;
            text-align: center;
            left: 0;
            right: 0;
            height: 100vh;
            background-color: #080808d7;
            display: none;
          }
          .preview{
            display:none;
            width: 470px;
          }
          .resultsFilerSelect{
            margin-top: 10%;
            width: 570px;
            margin: 0px auto 10px;
          }

          @media(max-width:999px){
            .resultsFilerSelect{
              width: 80%;
            }
          }
          .sendFig{
            width: 70%;
            padding: 8px;
          }
        </style>
          <div class="name-hacker">
        <span id="hacker"></span>
        </div>
      </div>
        <form id="message-form">
          <div class="inty">
            <input type="text" id="message-input" placeholder="Message" required onfocus="this.placeholder=''" onblur="this.placeholder='Message'" required>
          </div>
            <button type="submit" class="sed"><span><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M470.3 271.15L43.16 447.31a7.83 7.83 0 01-11.16-7V327a8 8 0 016.51-7.86l247.62-47c17.36-3.29 17.36-28.15 0-31.44l-247.63-47a8 8 0 01-6.5-7.85V72.59c0-5.74 5.88-10.26 11.16-8L470.3 241.76a16 16 0 010 29.39z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg></span>Sender</button>
            <audio id="sound" src="./spacebar-click-keyboard-199448.mp3"></audio>
         <script>
            const enterbot = document.querySelector('.sed');
const sound = document.getElementById('sound');

enterbot.addEventListener('click', () =>{
    sound.play();
})
          </script>
          </form>
  </div>
</div>
<div class="color-formu">
  <div class="ping">
    <div class="divhomer">
      <div class="divc"></div>
      <div class="divc"></div>
      <div class="divc"></div>
    </div>
    <div class="pipi">
      <p class="pi">The internet signal is: <span id="signalStrength">Checking...</span></p>
    </div>
    <script>
      document.querySelector('.divhomer').addEventListener('click', function(){
        var usersLoginHome = document.querySelector('.usersLogin');
      if(usersLoginHome.style.left == '-470px' || usersLoginHome.style.left == ''){
        usersLoginHome.style.left = "0px";
      } else {
        usersLoginHome.style.left = "-470px";
      }
      })
    </script>
  </div>
  </div>
  </section>
<br>
<br>
    <script>
  const ws = new WebSocket('wss://wss-9fes.onrender.com');
const login = document.querySelector(".login");
const chat = document.querySelector(".chat");
const loginForm = login.querySelector(".login--form");
const nameInput = document.getElementById('name-input');
const haCker = document.getElementById('hacker');
const messageInput = document.getElementById('message-input');
const messageForm = document.getElementById('message-form');
const chatBox = document.getElementById('chat-box');
const uploadImageInput = document.getElementById("selectimage");
const sendImageForm = document.getElementById("sendFilerT");
const messagesContainer = document.getElementById("messages-container");
let userName = ''; // Nome do usuário

function Hacker() {
var nome = document.getElementById('name-input').value;
const user = document.getElementById('name-input');
document.getElementById('hacker').innerText = "user : " + nome;

if(user.value.trim() !== ''){

}
}1 
const user = { id: "", name: "" }

ws.onopen = () => {
  console.log('Connection established with the server.');
  console.log(user)
};

const SCroll = () => {
const scrollableDiv = document.getElementById("chat-box");
window.scrollTo({
top: scrollableDiv.scrollHeight,
behavior: "smooth"
});
};


const SCroll3 = () => {
  window.scrollTo({
    //top: document.body.scrollHeight,
    top: document.documentElement.scrollHeight,
    behavior: "smooth"
  });
};

ws.onmessage = (event) => {
  handleReceivedMessage(event.data);
};

function handleReceivedMessage(data){
  try {
    const messageData = JSON.parse(data);
    displayReceivedMessage(messageData.sender, messageData.message);
  } catch (error) {
    console.error('Error processing received data:', error);
  }
}

ws.onclose = (event) => {
  if (event.wasClean) {
    console.log('Conexão fechada limpa.');
  } else {
    console.error('Conexão interrompida.'); 
  }
};

function displayReceivedMessage(sender, message) {
  const now = new Date();
        const options = {
            hour: '2-digit',
            minute: '2-digit',
            //second: '2-digit',
            hour12 : false
        };
        const formattedDateTime = now.toLocaleDateString('en-US', options);
        const wer = `<strong style="font-size:12px; color:#807e7e;">${formattedDateTime}</strong>`

  const receivedMessageDiv = document.createElement('div');
  receivedMessageDiv.innerHTML = ` 
  <strong style="font-size:15px;">${sender} ${wer}<br></strong>${formatMessage(message)}<br>`;
  chatBox.appendChild(receivedMessageDiv);
}

// image ---------------------------

// teste ---------------------------

function formatMessage(message) {
// Verifica se a mensagem contém um link
const linkRegex = /https?:\/\/\S+/;
if (linkRegex.test(message)) {
// Se a mensagem contém um link, aplica um estilo diferente para o link
return message.replace(linkRegex, '<a href="$&" style="color: #ff0000;" target="_blank">$&</a>');
} else {
return message;
}
}
messageForm.addEventListener('submit', (event) => {
event.preventDefault();

userName = nameInput.value || 'Anônimo';

const message = messageInput.value;
ws.send(JSON.stringify({ sender: userName, message: message }));

displaySentMessage(message);

messageInput.value = ''; // Limpa o campo de entrada após o envio da mensagem
document.querySelector(".name-input").style.display = "none"
});

const sendMessage = (event) => {
event.preventDefault()

const message = {
  userId: user.id,
  userName: user.name,
  content: messageInput.value
}
//websocket.send(JSON.stringify(message))

messageInput.value = ""
SCroll();
}

const handleSubmit = (event) => {
event.preventDefault()

user.id = crypto.randomUUID()
user.name = nameInput.value
const usernamegg = document.getElementById('usernamegg');
const usernameid = document.getElementById('usernameid');
usernamegg.innerText = user.name;
usernameid.innerText = user.id;

//document.querySelector(".login").style.display = "none"
document.querySelector(".chat").style.display = "flex"

//websocket = new WebSocket("ws://localhost:8080")
//websocket.onmessage = processMessage
}

const hacker = (event) => {
sender = { nameInput }
hacker.innerHTML = `<strong>${sender}:</strong>`;
console.log(`Hello ${sender}`)
}

function checkInternetConnection() {
    fetch('https://www.google.com')
      .then(response => {
        if (response.ok) {
          document.getElementById('signalStrength').textContent = 'Good';
          document.getElementById('signalStrength').style.color = 'green';
        } else {
          document.getElementById('signalStrength').textContent = 'Bad';
          document.getElementById('signalStrength').style.color = 'red';
        }
      })
      .catch(error => {
        document.getElementById('signalStrength').textContent = 'Bad';
        document.getElementById('signalStrength').style.color = 'red';
      });
  }

  // Verifica a conexão inicialmente
  checkInternetConnection();

  // Verifica a conexão a cada 5 segundos
  setInterval(checkInternetConnection, 5000);

loginForm.addEventListener("submit", handleSubmit)
messageForm.addEventListener("submit", sendMessage )


</script>
    <style>

:root{
    --font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}


  #image{
    display: none;
  }

  img {
    margin-top: 20px;
    max-width: 100%;
    max-height: 400px;
    border: 1px solid #ddd;
    padding: 5px;
    background-color: #000000;
    width: 80%;
  }

  @keyframes --pish{
    from{
        border: 2px solid #f7f7f7;
        transition: 0.5s;
    }
    to{
        border: 2px dashed #ffffff;
        transition: 0.5s;
    }
  }

  .upload-image {
    cursor: pointer;
    padding: 10px;
    width: 100%;
    margin: 0 auto 10px;
  }


  .select{
    display: flex;
    justify-content: center;
    margin: 0 auto 10px;
    position: fixed;
    right: 0;
    bottom: 10%;
  }

  .filesr{
    text-align: left;
    width: 100%;
    background-color: black;
  }

  .namepas{
    background-color: #080808;
    padding: 10px;
    border-radius: 5px;
    border: none;
    font-family: var(--sam);
    font-size: 20px;
    outline: none;
    color: #ffffff;
    font-weight: 600;

  }


  .btn{
    width: 450px;
    margin-top: 20px;
    justify-content: center;
    background-color: #ffffff;
    font-family: var(--sam);
    font-weight: 600;
    font-size: 18px;
    color: #000000;
    padding: 10px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    transition: 0.5s;
    display:none;
    animation: --desktop 0.7s linear;
  }

  @keyframes --desktop{
    from{
      width: 350px;
    }
    to{
      width: 420px;
    }
  }

  .btn:disabled{
    width: 450px;
    margin-top: 20px;
    justify-content: center;
    background-color: #dd1515;
    font-family: var(--sam);
    font-weight: 600;
    font-size: 18px;
    color: #ffffff;
    padding: 10px 40px;
    border-radius: 20px;
    border: none;
    cursor: not-allowed;
    transition: 0.5s;
    display:none;
    opacity: 0.7;
    animation: --desktop 0.7s linear;
  }

  @media(max-width:999px){
    .btn{
      width: 80%;
       animation: --anime 0.7s linear;
    }
    .btn:disabled{
      width: 80%;
      animation: --anime 0.7s linear;
    }
  }
  

  @keyframes --anime{
    from{
        width: 50%;
        color: transparent;
    }
    to{
        width: 85%;
    }
  }

  .btn:hover{
    background-color: #b9b9b9;
    transition: 0.5s;
  }

    </style>
    </div>
</body>
</html>
